{"ast":null,"code":"import { fetchCard, getLogin, getDeckList, saveToList, getDefault, getRegister, getUser, saveCard, deleteCard, deleteDeck } from \"../../api\";\nimport Erasure from \"../../images/Erasure.jpg\";\nexport const GET_CARD = \"GET_CARD\";\nexport const DISPLAY_CARD = \"DISPLAY_CARD\";\nexport const IS_LOADED = \"IS_LOADED\";\nexport const LOGIN = \"LOGIN\";\nexport const GET_DECK = \"GET_DECK\";\nexport const ADD_CARD = \"ADD_CARD\";\nexport const MODIFY_DECK = \"MODIFY_DECK\";\nexport const MY_CARD = \"MY_CARD\";\nexport const REGISTER = \"REGISTER\";\nexport const ERROR = \"ERROR\";\nexport const AUTH = \"AUTH\";\nexport const ADD_DECK = \"ADD_DECK\";\nexport const DB_DECK = \"DB_DECK\";\nexport const LOAD_DECK = \"LOAD_DECK\";\nexport const LOGOUT = \"LOGOUT\";\nexport const DB_CARD = \"DB_CARD\";\nexport const DELETE_DECK = \"DELETE_DECK\";\nexport function addCard(card) {\n  return {\n    type: ADD_CARD,\n    card\n  };\n}\nexport function modifyDeck(modifier, index) {\n  return {\n    type: MODIFY_DECK,\n    modifier,\n    index\n  };\n}\nexport function displayCard(cardList) {\n  return {\n    type: DISPLAY_CARD,\n    cardList\n  };\n}\nexport function isLoaded(value) {\n  return {\n    type: IS_LOADED,\n    value\n  };\n}\nexport function isError(value) {\n  return {\n    type: ERROR,\n    value\n  };\n}\nexport function isAuth(value) {\n  return {\n    type: AUTH,\n    value\n  };\n}\nexport function logout() {\n  return {\n    type: LOGOUT\n  };\n}\nexport function myCard(card) {\n  return {\n    type: MY_CARD,\n    card\n  };\n}\nexport function addDeck(deck) {\n  return {\n    type: ADD_DECK,\n    deck\n  };\n}\nexport function dbDecks(decks) {\n  return {\n    type: DB_DECK,\n    decks\n  };\n}\nexport function dbCard(cards) {\n  return {\n    type: DB_CARD,\n    cards\n  };\n}\nexport function loadDeck(deck) {\n  return {\n    type: LOAD_DECK,\n    deck\n  };\n}\nexport function saveMyCard(card) {\n  const payload = {\n    card: card,\n    token: localStorage.getItem(\"token\")\n  };\n  return function (dispatch) {\n    dispatch(isLoaded(false));\n    return saveCard(payload).then(res => {\n      //only adds if card is not duplicate\n      if (res.data.error) {\n        dispatch(myCard(card));\n      }\n\n      dispatch(isLoaded(true));\n    });\n  };\n}\nexport function deleteMyCard(card) {\n  const payload = {\n    card: card,\n    token: localStorage.getItem(\"token\")\n  };\n  return function (dispatch) {\n    dispatch(isLoaded(false));\n    return deleteCard(payload).then(res => {\n      dispatch(user(payload.token));\n      dispatch(isLoaded(true));\n    });\n  };\n}\nexport function deleteMyDeck(deck) {\n  const payload = {\n    deckname: deck.name,\n    token: localStorage.getItem(\"token\")\n  };\n  return function (dispatch) {\n    dispatch(isLoaded(false));\n    return deleteDeck(payload).then(res => {\n      dispatch(user(payload.token));\n      dispatch(isLoaded(true));\n    });\n  };\n}\nexport function login(value) {\n  return function (dispatch) {\n    dispatch(isLoaded(false));\n    return getLogin(value).then(res => {\n      if (res.data.token) {\n        localStorage.setItem(\"token\", res.data.token);\n        dispatch(isError(false));\n        dispatch(user(res.data.token));\n      } else {\n        dispatch(isError(\"Invalid Username Or Password\"));\n      }\n\n      dispatch(isLoaded(true));\n    });\n  };\n}\nexport function user(token) {\n  return function (dispatch) {\n    dispatch(isLoaded(false));\n    return getUser(token).then(res => {\n      console.log(res);\n      let decks = [];\n      let allDecks = [];\n      let myCards = [];\n      res.data[0].map(item => {\n        decks.push(JSON.parse(item.decklist));\n      });\n      res.data[1].map(item => {\n        myCards.push(JSON.parse(item.card));\n      });\n      res.data[2].map(item => {\n        allDecks.push(JSON.parse(item.decklist));\n      });\n      dispatch(dbDecks(allDecks));\n      dispatch(addDeck(decks));\n      dispatch(dbCard(myCards));\n      dispatch(isAuth(true));\n      dispatch(isLoaded(true));\n    });\n  };\n}\nexport function getData() {\n  return function (dispatch) {\n    dispatch(isLoaded(false));\n    return getDefault().then(res => {\n      if (res.data) {\n        let allDecks = [];\n        res.data.map(item => {\n          allDecks.push(JSON.parse(item.decklist));\n        });\n        dispatch(dbDecks(allDecks));\n        dispatch(isLoaded(true));\n      } else {\n        alert(\"Server is Down For Maintenance\");\n      }\n    });\n  };\n}\nexport function register(value) {\n  return function (dispatch) {\n    dispatch(isLoaded(false));\n    return getRegister(value).then(res => {\n      const token = res.data.token;\n\n      if (res.data.error) {\n        dispatch(isError(\"User Already Exists\"));\n      } else {\n        localStorage.setItem(\"token\", res.data.token);\n        dispatch(isError(false));\n        dispatch(user(token));\n      }\n\n      dispatch(isLoaded(true));\n    });\n  };\n}\nexport function saveDeck(deckName, deck) {\n  const payload = {\n    newDeck: {\n      name: deckName,\n      decklist: deck.decklist\n    },\n    token: localStorage.getItem(\"token\"),\n    id: deck.id\n  };\n  return function (dispatch) {\n    dispatch(isLoaded(false));\n    const token = localStorage.getItem(\"token\");\n    return saveToList(payload).then(res => {\n      if (res.data.error) {\n        alert(\"Duplicate Deckname\");\n      } else {\n        dispatch(user(token));\n        alert(\"Decklist Saved\");\n      }\n\n      dispatch(isLoaded(true));\n    });\n  };\n}\nexport function getDeck(deck) {\n  return function (dispatch) {\n    dispatch(isLoaded(false));\n    return getDeckList({\n      deck\n    }).then(res => {\n      dispatch(loadDeck(res.data.result));\n      dispatch(isLoaded(true));\n    });\n  };\n}\nexport function getCard(query) {\n  return function (dispatch) {\n    dispatch(isLoaded(false));\n    return fetchCard(query).then(res => {\n      //filter the data by assigning it's name to a key in an object and the response object as value of the key\n      let filtered = {};\n\n      if (res.data.cards.length === 0) {\n        filtered = [{\n          name: \"No Cards Found\",\n          imageUrl: Erasure\n        }];\n      } else {\n        res.data.cards.forEach(card => {\n          //Look in the filtered object for the card name key, if undefined save as the card with matching key\n          if (filtered[card.name] === undefined) {\n            filtered[card.name] = card; //if card has no image and the current card from the response has an image save the current card.\n          } else if (filtered[card.name][\"imageUrl\"] === undefined && card.imageUrl) {\n            filtered[card.name] = card;\n          }\n        });\n      }\n\n      dispatch(displayCard(filtered));\n      dispatch(isLoaded(true));\n    });\n  };\n}","map":{"version":3,"sources":["/home/andrew/mtg/client/src/store/actions/index.js"],"names":["fetchCard","getLogin","getDeckList","saveToList","getDefault","getRegister","getUser","saveCard","deleteCard","deleteDeck","Erasure","GET_CARD","DISPLAY_CARD","IS_LOADED","LOGIN","GET_DECK","ADD_CARD","MODIFY_DECK","MY_CARD","REGISTER","ERROR","AUTH","ADD_DECK","DB_DECK","LOAD_DECK","LOGOUT","DB_CARD","DELETE_DECK","addCard","card","type","modifyDeck","modifier","index","displayCard","cardList","isLoaded","value","isError","isAuth","logout","myCard","addDeck","deck","dbDecks","decks","dbCard","cards","loadDeck","saveMyCard","payload","token","localStorage","getItem","dispatch","then","res","data","error","deleteMyCard","user","deleteMyDeck","deckname","name","login","setItem","console","log","allDecks","myCards","map","item","push","JSON","parse","decklist","getData","alert","register","saveDeck","deckName","newDeck","id","getDeck","result","getCard","query","filtered","length","imageUrl","forEach","undefined"],"mappings":"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","sourcesContent":["import {fetchCard, getLogin, getDeckList, saveToList, getDefault, getRegister, getUser, saveCard, deleteCard, deleteDeck} from \"../../api\"\nimport Erasure from \"../../images/Erasure.jpg\"\n\n\nexport const GET_CARD = \"GET_CARD\"\nexport const DISPLAY_CARD = \"DISPLAY_CARD\"\nexport const IS_LOADED = \"IS_LOADED\"\nexport const LOGIN = \"LOGIN\"\nexport const GET_DECK = \"GET_DECK\"\nexport const ADD_CARD = \"ADD_CARD\"\nexport const MODIFY_DECK = \"MODIFY_DECK\"\nexport const MY_CARD = \"MY_CARD\"\nexport const REGISTER = \"REGISTER\"\nexport const ERROR = \"ERROR\"\nexport const AUTH = \"AUTH\"\nexport const ADD_DECK = \"ADD_DECK\"\nexport const DB_DECK = \"DB_DECK\"\nexport const LOAD_DECK = \"LOAD_DECK\"\nexport const LOGOUT = \"LOGOUT\"\nexport const DB_CARD =\"DB_CARD\"\nexport const DELETE_DECK = \"DELETE_DECK\"\n\n\nexport function addCard(card){\n    return {type: ADD_CARD, card}\n}\n\nexport function modifyDeck(modifier, index){\n    return {type: MODIFY_DECK, modifier, index}\n}\n\nexport function displayCard(cardList){\n    return {type: DISPLAY_CARD, cardList}\n}\n\nexport function isLoaded(value){\n    return {type:IS_LOADED, value}\n}\n\nexport function isError(value){\n    return {type:ERROR, value}\n}\nexport function isAuth(value){\n    return {type:AUTH, value}\n}\n\nexport function logout(){\n    return {type:LOGOUT}\n}\n\nexport function myCard(card){\n    return {type:MY_CARD, card}\n}\n\nexport function addDeck(deck){\n    return {type:ADD_DECK, deck}\n}\nexport function dbDecks(decks){\n    return {type:DB_DECK, decks}\n}\nexport function dbCard(cards){\n    return {type:DB_CARD, cards};\n}\n\nexport function loadDeck(deck){\n    return {type:LOAD_DECK, deck}\n}\n\nexport function saveMyCard(card){\n    const payload = {card: card, token:localStorage.getItem(\"token\")};\n\n    return function(dispatch){\n        dispatch(isLoaded(false));\n        return saveCard(payload).then(res=>{\n\n            //only adds if card is not duplicate\n            if(res.data.error){\n                dispatch(myCard(card))\n            }\n            \n            dispatch(isLoaded(true))\n        })\n    }\n}\n\nexport function deleteMyCard(card){\n    const payload = {card: card, token:localStorage.getItem(\"token\")}\n    return function(dispatch){\n        dispatch(isLoaded(false));\n        return deleteCard(payload).then(res=>{\n            \n            dispatch(user(payload.token))\n            dispatch(isLoaded(true))\n        })\n    }\n}\n\nexport function deleteMyDeck(deck){\n    const payload = {deckname: deck.name, token:localStorage.getItem(\"token\")};\n    return function(dispatch){\n        dispatch(isLoaded(false));\n        return deleteDeck(payload).then(res=>{\n            dispatch(user(payload.token));\n            dispatch(isLoaded(true));\n        })\n    }\n}\n\nexport function login(value){\n    return function(dispatch){\n        dispatch(isLoaded(false))\n        return getLogin(value).then(res=>{\n            if(res.data.token){\n                localStorage.setItem(\"token\",res.data.token)\n                dispatch(isError(false))\n                dispatch(user(res.data.token))\n            }else{\n                dispatch(isError(\"Invalid Username Or Password\"))\n            }\n            dispatch(isLoaded(true))\n        })\n        \n    }\n}\n\nexport function user(token){\n    return function(dispatch){\n        dispatch(isLoaded(false))\n        return getUser(token).then(res=>{\n            \n            console.log(res)\n            let decks=[];\n            let allDecks=[];\n            let myCards=[]\n            res.data[0].map(item=>{\n                decks.push(JSON.parse(item.decklist))\n            })\n\n            res.data[1].map(item=>{\n                \n                myCards.push(JSON.parse(item.card))\n            })\n\n            res.data[2].map(item=>{\n                allDecks.push(JSON.parse(item.decklist))\n            })\n\n            dispatch(dbDecks(allDecks))\n            dispatch(addDeck(decks))\n            dispatch(dbCard(myCards))\n            dispatch(isAuth(true))\n            dispatch(isLoaded(true))\n\n        })\n        \n    }\n}\n\nexport function getData(){\n    return function(dispatch){\n        dispatch(isLoaded(false))\n        return getDefault().then((res)=>{\n            if(res.data){\n                let allDecks=[];\n            \n                res.data.map(item=>{\n                    allDecks.push((JSON.parse(item.decklist)))\n                })\n                \n                dispatch(dbDecks(allDecks))\n                dispatch(isLoaded(true))\n            }else{\n                alert(\"Server is Down For Maintenance\");\n            }\n        })\n    }\n}\n\nexport function register(value){\n    return function(dispatch){\n        \n        dispatch(isLoaded(false))\n\n        return getRegister(value).then(res=>{\n\n            const token = res.data.token\n            if(res.data.error){\n                dispatch(isError(\"User Already Exists\"))\n            }else{\n                localStorage.setItem(\"token\",res.data.token)\n                dispatch(isError(false))\n                dispatch(user(token))\n            }\n            \n            dispatch(isLoaded(true))\n        }) \n        \n    }\n}\n\nexport function saveDeck(deckName, deck){\n    \n    const payload = {newDeck: {name:deckName, decklist: deck.decklist}, token:localStorage.getItem(\"token\"), id: deck.id}\n    \n    return function(dispatch){\n\n        dispatch(isLoaded(false))\n        const token = localStorage.getItem(\"token\")\n        return saveToList(payload).then((res)=>{\n            \n            if(res.data.error){\n                alert(\"Duplicate Deckname\")\n            }else{\n                dispatch(user(token))\n                alert(\"Decklist Saved\")\n            }\n            \n            dispatch(isLoaded(true))\n\n        })\n        \n    }\n    \n}\n\nexport function getDeck (deck){\n    return function(dispatch){\n        dispatch(isLoaded(false))\n        return getDeckList({deck}).then((res)=>{\n            \n            dispatch(loadDeck(res.data.result))\n            \n            dispatch(isLoaded(true))\n        })\n        \n    }\n}\n\nexport function getCard (query){\n\n    return function(dispatch){\n\n        dispatch(isLoaded(false))\n\n        return fetchCard(query).then((res)=>{\n            \n            //filter the data by assigning it's name to a key in an object and the response object as value of the key\n            let filtered={};\n            \n            if(res.data.cards.length===0){\n                filtered = [{name:\"No Cards Found\", imageUrl:Erasure}];\n            }else{\n                res.data.cards.forEach((card)=>{\n                    //Look in the filtered object for the card name key, if undefined save as the card with matching key\n                    if(filtered[card.name]===undefined){\n                        filtered[card.name] = card;\n                    //if card has no image and the current card from the response has an image save the current card.\n                    }else if(filtered[card.name][\"imageUrl\"]===undefined && card.imageUrl){\n                        filtered[card.name] = card;\n                    }\n                });\n            }\n            \n\n\n            dispatch(displayCard(filtered))\n\n            dispatch(isLoaded(true))\n\n        })\n    }\n}\n\n\n"]},"metadata":{},"sourceType":"module"}