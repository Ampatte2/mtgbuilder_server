{"ast":null,"code":"import { fetchCard, getLogin, getDeckList, saveToList, getDefault, getRegister, getUser, saveCard, deleteCard, deleteDeck } from \"../../api\";\nimport Erasure from \"../../images/Erasure.jpg\";\nexport const GET_CARD = \"GET_CARD\";\nexport const DISPLAY_CARD = \"DISPLAY_CARD\";\nexport const IS_LOADED = \"IS_LOADED\";\nexport const LOGIN = \"LOGIN\";\nexport const GET_DECK = \"GET_DECK\";\nexport const ADD_CARD = \"ADD_CARD\";\nexport const MODIFY_DECK = \"MODIFY_DECK\";\nexport const MY_CARD = \"MY_CARD\";\nexport const REGISTER = \"REGISTER\";\nexport const ERROR = \"ERROR\";\nexport const AUTH = \"AUTH\";\nexport const ADD_DECK = \"ADD_DECK\";\nexport const DB_DECK = \"DB_DECK\";\nexport const LOAD_DECK = \"LOAD_DECK\";\nexport const LOGOUT = \"LOGOUT\";\nexport const DB_CARD = \"DB_CARD\";\nexport const DELETE_DECK = \"DELETE_DECK\";\nexport const CLEAR_LIST = \"CLEAR_LIST\";\nexport function addCard(card) {\n  return {\n    type: ADD_CARD,\n    card\n  };\n}\nexport function modifyDeck(modifier, index) {\n  return {\n    type: MODIFY_DECK,\n    modifier,\n    index\n  };\n}\nexport function displayCard(cardList) {\n  return {\n    type: DISPLAY_CARD,\n    cardList\n  };\n}\nexport function isLoaded(value) {\n  return {\n    type: IS_LOADED,\n    value\n  };\n}\nexport function isError(value) {\n  return {\n    type: ERROR,\n    value\n  };\n}\nexport function isAuth(value) {\n  return {\n    type: AUTH,\n    value\n  };\n}\nexport function logout() {\n  return {\n    type: LOGOUT\n  };\n}\nexport function myCard(card) {\n  return {\n    type: MY_CARD,\n    card\n  };\n}\nexport function addDeck(deck) {\n  return {\n    type: ADD_DECK,\n    deck\n  };\n}\nexport function dbDecks(decks) {\n  return {\n    type: DB_DECK,\n    decks\n  };\n}\nexport function dbCard(cards) {\n  return {\n    type: DB_CARD,\n    cards\n  };\n}\nexport function loadDeck(deck) {\n  return {\n    type: LOAD_DECK,\n    deck\n  };\n}\nexport function clearList() {\n  return {\n    type: CLEAR_LIST\n  };\n}\nexport function saveMyCard(card) {\n  const payload = {\n    card: card,\n    token: localStorage.getItem(\"token\")\n  };\n  return function (dispatch) {\n    dispatch(isLoaded(false));\n    return saveCard(payload).then(res => {\n      //only adds if card is not duplicate\n      if (res.data.error) {\n        dispatch(myCard(card));\n      }\n\n      dispatch(isLoaded(true));\n    });\n  };\n}\nexport function deleteMyCard(card) {\n  const payload = {\n    card: card,\n    token: localStorage.getItem(\"token\")\n  };\n  return function (dispatch) {\n    dispatch(isLoaded(false));\n    return deleteCard(payload).then(res => {\n      dispatch(user(payload.token));\n      dispatch(isLoaded(true));\n    });\n  };\n}\nexport function deleteMyDeck(deck) {\n  const payload = {\n    deckname: deck.name,\n    token: localStorage.getItem(\"token\")\n  };\n  return function (dispatch) {\n    dispatch(isLoaded(false));\n    return deleteDeck(payload).then(res => {\n      dispatch(user(payload.token));\n      dispatch(isLoaded(true));\n    });\n  };\n}\nexport function login(value) {\n  return function (dispatch) {\n    dispatch(isLoaded(false));\n    return getLogin(value).then(res => {\n      if (res.data.token) {\n        localStorage.setItem(\"token\", res.data.token);\n        dispatch(isError(false));\n        dispatch(user(res.data.token));\n      } else {\n        dispatch(isError(\"Invalid Username Or Password\"));\n      }\n\n      dispatch(isLoaded(true));\n    });\n  };\n}\nexport function user(token) {\n  return function (dispatch) {\n    dispatch(isLoaded(false));\n    return getUser(token).then(res => {\n      let decks = [];\n      let allDecks = [];\n      let myCards = [];\n      res.data[0].map(item => {\n        decks.push(JSON.parse(item.decklist));\n      });\n      res.data[1].map(item => {\n        myCards.push(JSON.parse(item.card));\n      });\n      res.data[2].map(item => {\n        allDecks.push(JSON.parse(item.decklist));\n      });\n      dispatch(dbDecks(allDecks));\n      dispatch(addDeck(decks));\n      dispatch(dbCard(myCards));\n      dispatch(isAuth(true));\n      dispatch(isLoaded(true));\n    });\n  };\n}\nexport function getData() {\n  return function (dispatch) {\n    dispatch(isLoaded(false));\n    return getDefault().then(res => {\n      let allDecks = [];\n      res.data.map(item => {\n        allDecks.push(JSON.parse(item.decklist));\n      });\n      dispatch(dbDecks(allDecks));\n      dispatch(isLoaded(true));\n    });\n  };\n}\nexport function register(value) {\n  return function (dispatch) {\n    dispatch(isLoaded(false));\n    return getRegister(value).then(res => {\n      const token = res.data.token;\n\n      if (res.data.error) {\n        dispatch(isError(\"User Already Exists\"));\n      } else {\n        localStorage.setItem(\"token\", res.data.token);\n        dispatch(isError(false));\n        dispatch(user(token));\n      }\n\n      dispatch(isLoaded(true));\n    });\n  };\n}\nexport function saveDeck(deckName, deck) {\n  const payload = {\n    newDeck: {\n      name: deckName,\n      decklist: deck.decklist\n    },\n    token: localStorage.getItem(\"token\"),\n    id: deck.id\n  };\n  return function (dispatch) {\n    dispatch(isLoaded(false));\n    const token = localStorage.getItem(\"token\");\n    return saveToList(payload).then(res => {\n      if (res.data.error) {\n        alert(\"Duplicate Deckname\");\n      } else {\n        dispatch(user(token));\n        alert(\"Decklist Saved\");\n      }\n\n      dispatch(isLoaded(true));\n    });\n  };\n}\nexport function getDeck(deck) {\n  return function (dispatch) {\n    dispatch(isLoaded(false));\n    return getDeckList({\n      deck\n    }).then(res => {\n      dispatch(loadDeck(res.data.result));\n      dispatch(isLoaded(true));\n    });\n  };\n}\nexport function getCard(query) {\n  return function (dispatch) {\n    dispatch(isLoaded(false));\n    return fetchCard(query).then(res => {\n      //filter the data by assigning it's name to a key in an object and the response object as value of the key\n      let filtered = {};\n\n      if (res.data.cards.length === 0) {\n        filtered = [{\n          name: \"No Cards Found\",\n          imageUrl: Erasure\n        }];\n      } else {\n        res.data.cards.forEach(card => {\n          //Look in the filtered object for the card name key, if undefined save as the card with matching key\n          if (filtered[card.name] === undefined) {\n            filtered[card.name] = card; //if card has no image and the current card from the response has an image save the current card.\n          } else if (filtered[card.name][\"imageUrl\"] === undefined && card.imageUrl) {\n            filtered[card.name] = card;\n          }\n        });\n      }\n\n      dispatch(displayCard(filtered));\n      dispatch(isLoaded(true));\n    });\n  };\n}","map":{"version":3,"sources":["/home/andrew/mtg/client/src/store/actions/index.js"],"names":["fetchCard","getLogin","getDeckList","saveToList","getDefault","getRegister","getUser","saveCard","deleteCard","deleteDeck","Erasure","GET_CARD","DISPLAY_CARD","IS_LOADED","LOGIN","GET_DECK","ADD_CARD","MODIFY_DECK","MY_CARD","REGISTER","ERROR","AUTH","ADD_DECK","DB_DECK","LOAD_DECK","LOGOUT","DB_CARD","DELETE_DECK","CLEAR_LIST","addCard","card","type","modifyDeck","modifier","index","displayCard","cardList","isLoaded","value","isError","isAuth","logout","myCard","addDeck","deck","dbDecks","decks","dbCard","cards","loadDeck","clearList","saveMyCard","payload","token","localStorage","getItem","dispatch","then","res","data","error","deleteMyCard","user","deleteMyDeck","deckname","name","login","setItem","allDecks","myCards","map","item","push","JSON","parse","decklist","getData","register","saveDeck","deckName","newDeck","id","alert","getDeck","result","getCard","query","filtered","length","imageUrl","forEach","undefined"],"mappings":"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","sourcesContent":["import {fetchCard, getLogin, getDeckList, saveToList, getDefault, getRegister, getUser, saveCard, deleteCard, deleteDeck} from \"../../api\"\nimport Erasure from \"../../images/Erasure.jpg\"\n\n\nexport const GET_CARD = \"GET_CARD\"\nexport const DISPLAY_CARD = \"DISPLAY_CARD\"\nexport const IS_LOADED = \"IS_LOADED\"\nexport const LOGIN = \"LOGIN\"\nexport const GET_DECK = \"GET_DECK\"\nexport const ADD_CARD = \"ADD_CARD\"\nexport const MODIFY_DECK = \"MODIFY_DECK\"\nexport const MY_CARD = \"MY_CARD\"\nexport const REGISTER = \"REGISTER\"\nexport const ERROR = \"ERROR\"\nexport const AUTH = \"AUTH\"\nexport const ADD_DECK = \"ADD_DECK\"\nexport const DB_DECK = \"DB_DECK\"\nexport const LOAD_DECK = \"LOAD_DECK\"\nexport const LOGOUT = \"LOGOUT\"\nexport const DB_CARD =\"DB_CARD\"\nexport const DELETE_DECK = \"DELETE_DECK\"\nexport const CLEAR_LIST = \"CLEAR_LIST\"\n\n\nexport function addCard(card){\n    return {type: ADD_CARD, card}\n}\n\nexport function modifyDeck(modifier, index){\n    return {type: MODIFY_DECK, modifier, index}\n}\n\nexport function displayCard(cardList){\n    return {type: DISPLAY_CARD, cardList}\n}\n\nexport function isLoaded(value){\n    return {type:IS_LOADED, value}\n}\n\nexport function isError(value){\n    return {type:ERROR, value}\n}\nexport function isAuth(value){\n    return {type:AUTH, value}\n}\n\nexport function logout(){\n    return {type:LOGOUT}\n}\n\nexport function myCard(card){\n    return {type:MY_CARD, card}\n}\n\nexport function addDeck(deck){\n    return {type:ADD_DECK, deck}\n}\nexport function dbDecks(decks){\n    return {type:DB_DECK, decks}\n}\nexport function dbCard(cards){\n    return {type:DB_CARD, cards};\n}\n\nexport function loadDeck(deck){\n    return {type:LOAD_DECK, deck}\n}\nexport function clearList(){\n    return {type:CLEAR_LIST}\n}\n\nexport function saveMyCard(card){\n    const payload = {card: card, token:localStorage.getItem(\"token\")};\n\n    return function(dispatch){\n        dispatch(isLoaded(false));\n        return saveCard(payload).then(res=>{\n\n            //only adds if card is not duplicate\n            if(res.data.error){\n                dispatch(myCard(card))\n            }\n            \n            dispatch(isLoaded(true))\n        })\n    }\n}\n\nexport function deleteMyCard(card){\n    const payload = {card: card, token:localStorage.getItem(\"token\")}\n    return function(dispatch){\n        dispatch(isLoaded(false));\n        return deleteCard(payload).then(res=>{\n            \n            dispatch(user(payload.token))\n            dispatch(isLoaded(true))\n        })\n    }\n}\n\nexport function deleteMyDeck(deck){\n    const payload = {deckname: deck.name, token:localStorage.getItem(\"token\")};\n    return function(dispatch){\n        dispatch(isLoaded(false));\n        return deleteDeck(payload).then(res=>{\n            dispatch(user(payload.token));\n            dispatch(isLoaded(true));\n        })\n    }\n}\n\nexport function login(value){\n    return function(dispatch){\n        dispatch(isLoaded(false))\n        return getLogin(value).then(res=>{\n            if(res.data.token){\n                localStorage.setItem(\"token\",res.data.token)\n                dispatch(isError(false))\n                dispatch(user(res.data.token))\n            }else{\n                dispatch(isError(\"Invalid Username Or Password\"))\n            }\n            dispatch(isLoaded(true))\n        })\n        \n    }\n}\n\nexport function user(token){\n    return function(dispatch){\n        dispatch(isLoaded(false))\n        return getUser(token).then(res=>{\n            \n            \n            let decks=[];\n            let allDecks=[];\n            let myCards=[]\n            res.data[0].map(item=>{\n                decks.push(JSON.parse(item.decklist))\n            })\n\n            res.data[1].map(item=>{\n                \n                myCards.push(JSON.parse(item.card))\n            })\n\n            res.data[2].map(item=>{\n                allDecks.push(JSON.parse(item.decklist))\n            })\n\n            dispatch(dbDecks(allDecks))\n            dispatch(addDeck(decks))\n            dispatch(dbCard(myCards))\n            dispatch(isAuth(true))\n            dispatch(isLoaded(true))\n\n        })\n        \n    }\n}\n\nexport function getData(){\n    return function(dispatch){\n        dispatch(isLoaded(false))\n        return getDefault().then((res)=>{\n            \n            let allDecks=[];\n            \n            res.data.map(item=>{\n                allDecks.push((JSON.parse(item.decklist)))\n            })\n            \n            dispatch(dbDecks(allDecks))\n            dispatch(isLoaded(true))\n        })\n    }\n}\n\nexport function register(value){\n    return function(dispatch){\n        \n        dispatch(isLoaded(false))\n\n        return getRegister(value).then(res=>{\n\n            const token = res.data.token\n            if(res.data.error){\n                dispatch(isError(\"User Already Exists\"))\n            }else{\n                localStorage.setItem(\"token\",res.data.token)\n                dispatch(isError(false))\n                dispatch(user(token))\n            }\n            \n            dispatch(isLoaded(true))\n        }) \n        \n    }\n}\n\nexport function saveDeck(deckName, deck){\n    \n    const payload = {newDeck: {name:deckName, decklist: deck.decklist}, token:localStorage.getItem(\"token\"), id: deck.id}\n    \n    return function(dispatch){\n\n        dispatch(isLoaded(false))\n        const token = localStorage.getItem(\"token\")\n        return saveToList(payload).then((res)=>{\n            \n            if(res.data.error){\n                alert(\"Duplicate Deckname\")\n            }else{\n                dispatch(user(token))\n                alert(\"Decklist Saved\")\n            }\n            \n            dispatch(isLoaded(true))\n\n        })\n        \n    }\n    \n}\n\nexport function getDeck (deck){\n    return function(dispatch){\n        dispatch(isLoaded(false))\n        return getDeckList({deck}).then((res)=>{\n            \n            dispatch(loadDeck(res.data.result))\n            \n            dispatch(isLoaded(true))\n        })\n        \n    }\n}\n\nexport function getCard (query){\n\n    return function(dispatch){\n\n        dispatch(isLoaded(false))\n\n        return fetchCard(query).then((res)=>{\n            \n            //filter the data by assigning it's name to a key in an object and the response object as value of the key\n            let filtered={};\n            \n            if(res.data.cards.length===0){\n                filtered = [{name:\"No Cards Found\", imageUrl:Erasure}];\n            }else{\n                res.data.cards.forEach((card)=>{\n                    //Look in the filtered object for the card name key, if undefined save as the card with matching key\n                    if(filtered[card.name]===undefined){\n                        filtered[card.name] = card;\n                    //if card has no image and the current card from the response has an image save the current card.\n                    }else if(filtered[card.name][\"imageUrl\"]===undefined && card.imageUrl){\n                        filtered[card.name] = card;\n                    }\n                });\n            }\n            \n\n\n            dispatch(displayCard(filtered))\n\n            dispatch(isLoaded(true))\n\n        })\n    }\n}\n\n\n"]},"metadata":{},"sourceType":"module"}